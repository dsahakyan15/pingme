# AIPage Refactoring Documentation

## Overview

Этот проект демонстрирует рефакторинг компонента `AIPage` в соответствии с принципами SOLID, DRY и KISS. Изначально компонент был "божественным объектом", содержащим всю логику в одном файле.

## Принципы рефакторинга

### 1. Single Responsibility Principle (SRP)

Каждый модуль теперь имеет единственную зону ответственности:

- **AIPage** - только рендеринг и композиция компонентов
- **useAIChat** - управление AI чатом и состоянием сообщений
- **useQueryHistory** - управление историей запросов
- **Компоненты UI** - только отображение интерфейса

### 2. DRY (Don't Repeat Yourself)

- Вынесены общие утилиты в `utils/common.ts`
- Переиспользуемые компоненты (иконки, формы)
- Общие типы в `types.ts`

### 3. KISS (Keep It Simple, Stupid)

- Простая и понятная структура файлов
- Минимальная сложность в каждом модуле
- Четкие интерфейсы и API

## Структура после рефакторинга

```
src/
├── pages/
│   └── AIPage.tsx              # Главный компонент (только композиция)
├── hooks/
│   ├── useAIChat.ts           # Логика AI чата
│   └── useQueryHistory.ts     # Логика истории запросов
├── components/
│   ├── Icons.tsx              # SVG иконки
│   ├── Sidebar.tsx            # Боковая панель
│   ├── Header.tsx             # Заголовок
│   ├── ChatArea.tsx           # Область чата
│   └── MessageInput.tsx       # Форма ввода сообщения
├── utils/
│   └── common.ts              # Утилитарные функции
└── types.ts                   # Общие типы
```

## Преимущества рефакторинга

### 1. Читаемость кода

- **До**: 350+ строк в одном файле
- **После**: Максимум 50-100 строк в каждом модуле

### 2. Тестируемость

- Каждый хук и компонент можно тестировать независимо
- Четкие входные и выходные данные

### 3. Переиспользуемость

- Хуки можно использовать в других компонентах
- UI компоненты легко переносимы

### 4. Поддерживаемость

- Изменения в одной части не влияют на другие
- Легко добавлять новую функциональность

## Ключевые изменения

### useAIChat Hook

```typescript
// Инкапсулирует всю логику работы с AI
const { chatMessages, isLoading, sendMessage, clearChat } = useAIChat({
  apiKey,
});
```

### useQueryHistory Hook

```typescript
// Управляет историей запросов
const { history, addToHistory } = useQueryHistory();
```

### Компонентная архитектура

Каждый UI элемент вынесен в отдельный компонент с четким API:

```typescript
<Sidebar history={history} />
<Header onClearChat={handleClearChat} />
<ChatArea chatMessages={chatMessages} isLoading={isLoading} />
<MessageInput onSendMessage={handleSendMessage} isLoading={isLoading} />
```

## Результат

Основной компонент `AIPage` теперь содержит только:

- Инициализацию хуков
- Обработчики событий
- Композицию UI компонентов

Это делает код:

- ✅ Более читаемым
- ✅ Легко тестируемым
- ✅ Простым для понимания
- ✅ Готовым к расширению
